{% extends "base.html" %}

{% block title %}My Profile - MediBook{% endblock %}

{% block content %}
<div class="container page-spacer">
    <div class="dashboard-header" style="margin-bottom: 2rem;">
        <h2>My Profile</h2>
        <a href="{{ url_for('dashboard') }}" class="btn-outline"
            style="color: var(--secondary); border-color: var(--secondary);">Back to Dashboard</a>
    </div>

    <div class="card glass-light" style="max-width: 600px; margin: 0 auto; text-align: left;">
        <div style="text-align: center; margin-bottom: 2rem;">
            <div class="doctor-avatar" style="margin: 0 auto 1rem; width: 80px; height: 80px; font-size: 2rem;">
                {{ current_user.name[0] }}
            </div>
            <h3>{{ current_user.name }}</h3>
            <p class="specialization" style="margin-bottom: 0.5rem;">{{ current_user.role|title }}</p>
            {% if current_user.role == 'doctor' and current_user.doctor_profile %}
            <p style="color: var(--primary); font-weight: 500;">{{ current_user.doctor_profile.specialization }}</p>
            {% endif %}

            {% if current_user.membership_id %}
            <div
                style="background: var(--bg-light); padding: 0.5rem 1rem; border-radius: 50px; display: inline-block; font-family: monospace; letter-spacing: 1px;">
                ID: {{ current_user.membership_id }}
            </div>
            {% endif %}
        </div>

        <form method="POST">
            <h4 style="margin-bottom: 1rem; color: var(--secondary);">Personal Information</h4>
            
            <div class="form-group">
                <label class="form-label">Full Name</label>
                <input type="text" name="name" class="form-control" value="{{ current_user.name }}" required>
            </div>

            <div class="form-group">
                <label class="form-label">Email Address</label>
                <input type="email" name="email" class="form-control" value="{{ current_user.email }}" required>
            </div>

            <div class="form-group">
                <label class="form-label">Phone Number</label>
                <input type="tel" name="phone" class="form-control" value="{{ current_user.phone_number or '' }}"
                    placeholder="+1 (555) 000-0000">
            </div>

            {% if current_user.role == 'doctor' and current_user.doctor_profile %}
            <hr style="margin: 2rem 0; border: none; border-top: 1px solid #e0e0e0;">
            <h4 style="margin-bottom: 1rem; color: var(--secondary);">Professional Details</h4>

            <div class="form-group">
                <label class="form-label">Specialization</label>
                <input type="text" name="specialization" class="form-control" 
                    value="{{ current_user.doctor_profile.specialization }}" required>
            </div>

            <div class="form-group">
                <label class="form-label">Education</label>
                <textarea name="education" class="form-control" rows="3" 
                    placeholder="e.g., MD from Harvard Medical School, Board Certified in Internal Medicine">{{ current_user.doctor_profile.education or '' }}</textarea>
            </div>

            <div class="form-group">
                <label class="form-label">City</label>
                <input type="text" name="city" class="form-control" 
                    value="{{ current_user.doctor_profile.city or '' }}" placeholder="e.g., New York">
            </div>

            <div class="form-group">
                <label class="form-label">Country</label>
                <input type="text" name="country" class="form-control" 
                    value="{{ current_user.doctor_profile.country or '' }}" placeholder="e.g., USA">
            </div>

            <div class="form-group">
                <label class="form-label">Consultation Fee (USD)</label>
                <input type="number" name="consultation_fee" class="form-control" 
                    value="{{ current_user.doctor_profile.consultation_fee }}" min="0" step="0.01" required>
            </div>

            <div class="form-group">
                <label class="form-label">Years of Experience</label>
                <input type="number" name="experience_years" class="form-control" 
                    value="{{ current_user.doctor_profile.experience_years or '' }}" min="0" placeholder="10">
            </div>

            <div class="form-group">
                <label class="form-label">Associated Hospital</label>
                <select name="hospital_id" class="form-control">
                    <option value="">No Hospital Association</option>
                    {% for hospital in hospitals %}
                    <option value="{{ hospital.id }}" 
                        {% if current_user.doctor_profile.hospital_id == hospital.id %}selected{% endif %}>
                        {{ hospital.name }} - {{ hospital.city }}, {{ hospital.country }}
                    </option>
                    {% endfor %}
                </select>
                <small style="color: var(--text-muted); font-size: 0.85rem;">
                    Associate yourself with a hospital to appear in their listing
                </small>
            </div>

            <div class="form-group">
                <label class="form-label">Bio</label>
                <textarea name="bio" class="form-control" rows="4" 
                    placeholder="Tell patients about your background and expertise...">{{ current_user.doctor_profile.bio or '' }}</textarea>
            </div>
            {% endif %}

            <div style="margin-top: 2rem;">
                <button type="submit" class="btn-submit">Save Changes</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}